@page "/settings"
@using Pomodoro.Components.Layout
@using Pomodoro.Components.Pages.SmallComponents
@using Pomodoro.Entities
@using Pomodoro.Services
@inject PomodoroTimer pomodoroTimer
@inject IStatusBarService StatusBarService


<div class="container">
    <p class="top-title">Timer</p>
    <div class="row">
        <div class="col text-center">
            <i class="bi bi-plus-circle-fill top-icon" @onclick="IncreaseProduction"></i>
            <div class="square-col">
                <p>@ProductionTime</p>
            </div>
            <i class="bi bi-dash-circle-fill bottom-icon" @onclick="DecreaseProduction"></i>
        </div>
        <div class="col text-center">
            <i class="bi bi-plus-circle-fill top-icon" @onclick="IncreaseShortPause"></i>
            <div class="square-col">
                <p>@ShortPauseTime</p>
            </div>
            <i class="bi bi-dash-circle-fill bottom-icon" @onclick="DecreaseShortPause"></i>
        </div>
        <div class="col text-center">
            <i class="bi bi-plus-circle-fill top-icon" @onclick="IncreaseLongPause"></i>
            <div class="square-col">
                <p>@LongPauseTime</p>
            </div>
            <i class="bi bi-dash-circle-fill bottom-icon" @onclick="DecreaseLongPause"></i>
        </div>
    </div>
    <p class="title">Themes</p>
    <div class="row">
        <div class="col theme-square" @onclick="SetDarkTheme">
            <i class="bi bi-moon-fill moon-icon"></i>
        </div>
        <div class="col theme-square">
            <i class="bi bi-brightness-low-fill sun-icon" @onclick="SetLightTheme"></i>
        </div>
    </div>
</div>


<style>
    .top-title {
        text-align: center;
        font-size: 20px;
        font-weight: bolder;
        color: @AppStyleConfig.CurrentThemeItems;
        margin-bottom: 10px;
        margin-top: 45px;
    }

    .title {
        text-align: center;
        font-size: 20px;
        font-weight: bolder;
        color: @AppStyleConfig.CurrentThemeItems;
        margin-top: 45px;
    }
    .square-col {
        font-size: 45px;
        text-align: center;
        background: rgba(0,0,0,0.1);
        border: 2px solid rgba(0,0,0,0.0);
        border-radius: 5px;
        color: @AppStyleConfig.CurrentThemeItems;
        margin-left: 5px;
        margin-right: 5px;
    }

    .bottom-icon {
        color: @AppStyleConfig.CurrentThemeItems;
        font-size: 35px;
        margin-top: 7px;
    }

    .top-icon {
        color: @AppStyleConfig.CurrentThemeItems;
        font-size: 35px;
        margin-bottom: 7px;
    }

    .theme-square {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 140px;
        height: 170px;
        background: rgba(0,0,0,0.1);
        border: 2px solid rgba(0,0,0,0.0);
        border-radius: 5px;
        margin-left: 15px;
        margin-right: 15px;
    }

    .sun-icon {
        font-size: 120px;
        color: @AppStyleConfig.GetSunColor();
    }

    .moon-icon {
        font-size: 80px;
        color: @AppStyleConfig.GetMoonColor();
    }

    html, body {
        background-color: @AppStyleConfig.CurrentThemeBackground !important;
    }
</style>

@code{
    private int ProductionTime = Preferences.Get("Production", PomodoroTimer.ProductionLength);

    private int ShortPauseTime = Preferences.Get("ShortPause", PomodoroTimer.ShortPauseLength);

    private int LongPauseTime = Preferences.Get("LongPause", PomodoroTimer.LongPauseLength);

    protected override void OnInitialized()
    {
        base.OnInitialized();
    }

    private void IncreaseProduction()
    {
        if (ProductionTime + 1 < 100)
        {
            ProductionTime++;
            Preferences.Set("Production", ProductionTime);
            pomodoroTimer.SetProduction();
        }
    }

    private void DecreaseProduction()
    {
        if (ProductionTime - 1 > 0)
        {
            ProductionTime--;
            Preferences.Set("Production", ProductionTime);
            pomodoroTimer.SetProduction();
        }
    }

    private void IncreaseShortPause()
    {
        if (ShortPauseTime + 1 < 100)
        {
            ShortPauseTime++;
            Preferences.Set("ShortPause", ShortPauseTime);
            pomodoroTimer.SetShortPause();
        }
    }

    private void DecreaseShortPause()
    {
        if (ShortPauseTime - 1 > 0)
        {
            ShortPauseTime--;
            Preferences.Set("ShortPause", ShortPauseTime);
            pomodoroTimer.SetShortPause();
        }
    }

    private void IncreaseLongPause()
    {
        if (LongPauseTime + 1 < 100)
        {
            LongPauseTime++;
            Preferences.Set("LongPause", LongPauseTime);
            pomodoroTimer.SetLongPause();
        }
    }

    private void DecreaseLongPause()
    {
        if (LongPauseTime - 1 > 0)
        {
            LongPauseTime--;
            Preferences.Set("LongPause", LongPauseTime);
            pomodoroTimer.SetLongPause();
        }
    }

    private void SetDarkTheme()
    {
        AppStyleConfig.SetDarkTheme();
        NotifyChange.NavBarRefresh();
        StatusBarService.RefreshColor();
    }

    private void SetLightTheme()
    {
        AppStyleConfig.SetLightTheme();
        NotifyChange.NavBarRefresh();
        StatusBarService.RefreshColor();
    }
}


